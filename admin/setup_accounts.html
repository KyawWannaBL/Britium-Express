<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Britium Admin Setup (Fixed)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>
<body class="bg-light p-5">
    <div class="card p-4 mx-auto" style="max-width: 600px;">
        <h3>⚠️ Admin Account Generator</h3>
        <div class="alert alert-warning small">
            <strong>Before clicking:</strong><br>
            1. Ensure "Email/Password" is ENABLED in Firebase Console > Authentication.<br>
            2. Ensure you pasted your keys below.
        </div>
        
        <button id="runSetup" class="btn btn-primary w-100 fw-bold py-3">CREATE ACCOUNTS NOW</button>
        
        <div id="status" class="mt-3 p-3 bg-dark text-white rounded small" style="white-space: pre-line; min-height: 100px;">Waiting for user...</div>
    </div>

    <script>
        // 1. YOUR CONFIGURATION (PASTE KEYS HERE)
        const firebaseConfig = {
  apiKey: "AIzaSyCbrF5_QW6Nb3rBVkozT2y0KotL8clr8Jo",
  authDomain: "britium-express.firebaseapp.com",
  projectId: "britium-express",
  storageBucket: "britium-express.firebasestorage.app",
  messagingSenderId: "406522036528",
  appId: "1:406522036528:web:7713801d6832932067c8f5"
  
};

        // 2. Initialize Firebase (Compat Mode)
        try {
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const db = firebase.database();
            
            // 3. Accounts to Create
            const accounts = [
                { email: "mgkyawwanna@gmail.com", role: "super_admin", phone: "09887777585", pass: "Britium2026!" },
                { email: "md@britiumventures.com", role: "super_admin", phone: "09887777585", pass: "Britium2026!" },
                { email: "hod@britiumexpress.com", role: "manager", phone: "", pass: "Manager2026!" },
                { email: "hod_pm@britiumventures.com", role: "manager", phone: "", pass: "Manager2026!" }
            ];

            // 4. The Action Function
            document.getElementById('runSetup').addEventListener('click', async () => {
                const statusDiv = document.getElementById('status');
                statusDiv.innerText = "Processing... Please wait.\n";

                for (const acc of accounts) {
                    try {
                        statusDiv.innerText += `Attempting: ${acc.email}...\n`;
                        
                        // Create Auth User
                        const userCredential = await auth.createUserWithEmailAndPassword(acc.email, acc.pass);
                        const user = userCredential.user;

                        // Save Role to Database
                        await db.ref('users/' + user.uid).set({
                            email: acc.email,
                            role: acc.role,
                            phone: acc.phone,
                            createdAt: new Date().toISOString()
                        });

                        statusDiv.innerText += `✅ SUCCESS: ${acc.email} created as ${acc.role}.\n`;
                    } catch (error) {
                        if(error.code === 'auth/email-already-in-use') {
                            statusDiv.innerText += `⚠️ EXISTS: ${acc.email} is already created.\n`;
                        } else {
                            statusDiv.innerText += `❌ ERROR: ${acc.email} - ${error.message}\n`;
                        }
                    }
                }
                statusDiv.innerText += "\n--- PROCESS COMPLETE ---";
            });

        } catch (e) {
            document.getElementById('status').innerText = "CRITICAL ERROR: " + e.message + "\nDid you paste the config keys correctly?";
        }
    </script>
</body>
</html>
