<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Britium Admin Generator (Fixed)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
</head>
<body class="bg-light p-5">
    <div class="card p-4 mx-auto shadow" style="max-width: 600px;">
        <h3>üöÄ Admin Account Fixer</h3>
        <p class="text-muted">This tool will force-create your admin accounts.</p>
        
        <button id="runBtn" class="btn btn-primary w-100 fw-bold py-3">CLICK TO CREATE ACCOUNTS</button>
        
        <div id="status" class="mt-3 p-3 bg-dark text-white rounded small font-monospace" style="white-space: pre-line;">Waiting...</div>
    </div>

    <script>
        // ‚ö†Ô∏è STEP 1: PASTE YOUR REAL FIREBASE KEYS HERE
        // Go to Firebase Console -> Project Settings -> General -> Your Apps -> Web
           const firebaseConfig = {
           apiKey: "AIzaSyCbrF5_QW6Nb3rBVkozT2y0KotL8clr8Jo",
           authDomain: "britium-express.firebaseapp.com",
           projectId: "britium-express",
           storageBucket: "britium-express.firebasestorage.app",
           messagingSenderId: "406522036528",
           appId: "1:406522036528:web:7713801d6832932067c8f5"
};

        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const db = firebase.database();

            // The Accounts You Requested
            const accounts = [
                { email: "mgkyawwanna@gmail.com", role: "super_admin", phone: "09887777585", pass: "Britium2026!" },
                { email: "md@britiumventures.com", role: "super_admin", phone: "09887777585", pass: "Britium2026!" },
                { email: "hod@britiumexpress.com", role: "manager", phone: "", pass: "Manager2026!" },
                { email: "hod_pm@britiumventures.com", role: "manager", phone: "", pass: "Manager2026!" }
            ];

            document.getElementById('runBtn').addEventListener('click', async () => {
                const statusDiv = document.getElementById('status');
                statusDiv.innerText = "Starting Process...\n";

                for (const acc of accounts) {
                    try {
                        statusDiv.innerText += `\nCreating: ${acc.email}... `;
                        
                        // 1. Create Login
                        let uid;
                        try {
                            const userCred = await auth.createUserWithEmailAndPassword(acc.email, acc.pass);
                            uid = userCred.user.uid;
                            statusDiv.innerText += "‚úÖ Auth Created. ";
                        } catch (authError) {
                            if (authError.code === 'auth/email-already-in-use') {
                                statusDiv.innerText += "‚ö†Ô∏è Exists. Updating Role... ";
                                // If user exists, we need to find their UID to update the role.
                                // NOTE: Client SDK cannot look up UID by email directly for security.
                                // We will assume the user can login or we just skip.
                                // For a simple fixer, we try to sign in to get the UID.
                                try {
                                    const login = await auth.signInWithEmailAndPassword(acc.email, acc.pass);
                                    uid = login.user.uid;
                                } catch (e) {
                                    statusDiv.innerText += `‚ùå Cannot update (Wrong password?): ${e.message}`;
                                    continue;
                                }
                            } else {
                                throw authError;
                            }
                        }

                        // 2. Force Write Role to Database
                        if (uid) {
                            await db.ref('users/' + uid).set({
                                email: acc.email,
                                role: acc.role,
                                phone: acc.phone,
                                updatedAt: new Date().toISOString()
                            });
                            statusDiv.innerText += "‚úÖ Database Role Set!";
                        }

                    } catch (error) {
                        statusDiv.innerText += `\n‚ùå FAIL: ${error.message}`;
                    }
                }
                statusDiv.innerText += "\n\n‚ú® ALL DONE! You can delete this file.";
            });

        } catch (e) {
            document.getElementById('status').innerText = "CONFIG ERROR: Did you paste your keys? \n" + e.message;
        }
    </script>
</body>
</html>
